# Strove AI å†™ä½œåŠ©æ‰‹ - åç«¯é¡¹ç›®ç»“æ„è¯´æ˜æ–‡æ¡£

## ğŸ“‹ ç›®å½•
1. [é¡¹ç›®æ¦‚è§ˆ](#é¡¹ç›®æ¦‚è§ˆ)
2. [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
3. [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
4. [æ ¸å¿ƒæ¨¡å—è¯¦è§£](#æ ¸å¿ƒæ¨¡å—è¯¦è§£)
5. [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
6. [å¿«é€Ÿä¿®æ”¹æŒ‡å—](#å¿«é€Ÿä¿®æ”¹æŒ‡å—)
7. [å¸¸è§ä¿®æ”¹åœºæ™¯](#å¸¸è§ä¿®æ”¹åœºæ™¯)

---

## é¡¹ç›®æ¦‚è§ˆ

**é¡¹ç›®åç§°**: Strove AI å†™ä½œåŠ©æ‰‹åç«¯  
**æŠ€æœ¯æ¶æ„**: Spring Boot + JPA + MySQL  
**é¡¹ç›®ä½ç½®**: `e:\PROJECT\strove\src\main\java\com\erokin\strove`  
**åŒ…å**: `com.erokin.strove`

æœ¬é¡¹ç›®é‡‡ç”¨**æ ‡å‡†çš„ä¸‰å±‚æ¶æ„**ï¼ˆController - Service - Repositoryï¼‰ï¼Œç»“æ„æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•ã€‚

---

## æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Spring Boot 3.x
- **ORM**: Spring Data JPA + Hibernate
- **æ•°æ®åº“**: MySQL 8.0
- **å®‰å…¨**: Spring Security + JWT
- **æ„å»ºå·¥å…·**: Maven
- **Javaç‰ˆæœ¬**: Java 17+

---

## é¡¹ç›®ç»“æ„

```
src/main/java/com/erokin/strove/
â”‚
â”œâ”€â”€ StroveApplication.java          # åº”ç”¨ç¨‹åºå…¥å£ï¼ˆä¸»ç±»ï¼‰
â”‚
â”œâ”€â”€ config/                          # é…ç½®åŒ…
â”‚   â”œâ”€â”€ DatabaseAutoFixer.java      # æ•°æ®åº“è‡ªåŠ¨ä¿®å¤é…ç½®
â”‚   â”œâ”€â”€ HttpClientConfig.java       # HTTPå®¢æˆ·ç«¯é…ç½®
â”‚   â”œâ”€â”€ SecurityConfig.java         # å®‰å…¨é…ç½®ï¼ˆæ ¸å¿ƒï¼‰
â”‚   â”œâ”€â”€ WebConfig.java              # Webé…ç½®ï¼ˆCORSç­‰ï¼‰
â”‚   â””â”€â”€ properties/                 # é…ç½®å±æ€§ç±»
â”‚       â””â”€â”€ AppSecurityProperties.java
â”‚
â”œâ”€â”€ controller/                      # æ§åˆ¶å™¨å±‚ï¼ˆAPIæ¥å£ï¼‰
â”‚   â”œâ”€â”€ AIController.java           # AIç›¸å…³æ¥å£
â”‚   â”œâ”€â”€ AuthController.java         # è®¤è¯æ¥å£ï¼ˆç™»å½•/æ³¨å†Œï¼‰
â”‚   â”œâ”€â”€ DocumentController.java     # æ–‡æ¡£ç®¡ç†æ¥å£
â”‚   â”œâ”€â”€ HealthController.java       # å¥åº·æ£€æŸ¥æ¥å£
â”‚   â””â”€â”€ ToolController.java         # å·¥å…·ç±»æ¥å£
â”‚
â”œâ”€â”€ dto/                            # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”œâ”€â”€ ApiResponse.java            # ç»Ÿä¸€å“åº”æ ¼å¼
â”‚   â”œâ”€â”€ AuthResponse.java           # è®¤è¯å“åº”
â”‚   â”œâ”€â”€ ChatRequest.java            # èŠå¤©è¯·æ±‚
â”‚   â”œâ”€â”€ ChatResponse.java           # èŠå¤©å“åº”
â”‚   â”œâ”€â”€ DocumentRequest.java        # æ–‡æ¡£è¯·æ±‚
â”‚   â”œâ”€â”€ InspirationRequest.java     # çµæ„Ÿç”Ÿæˆè¯·æ±‚
â”‚   â”œâ”€â”€ LoginRequest.java           # ç™»å½•è¯·æ±‚
â”‚   â””â”€â”€ RegisterRequest.java        # æ³¨å†Œè¯·æ±‚
â”‚
â”œâ”€â”€ entity/                         # å®ä½“ç±»ï¼ˆæ•°æ®åº“æ˜ å°„ï¼‰
â”‚   â”œâ”€â”€ User.java                   # ç”¨æˆ·å®ä½“
â”‚   â”œâ”€â”€ Document.java               # æ–‡æ¡£å®ä½“
â”‚   â””â”€â”€ Conversation.java           # å¯¹è¯å®ä½“
â”‚
â”œâ”€â”€ exception/                      # å¼‚å¸¸å¤„ç†
â”‚   â””â”€â”€ GlobalExceptionHandler.java # å…¨å±€å¼‚å¸¸å¤„ç†å™¨
â”‚
â”œâ”€â”€ repository/                     # æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ UserRepository.java         # ç”¨æˆ·Repository
â”‚   â”œâ”€â”€ DocumentRepository.java     # æ–‡æ¡£Repository
â”‚   â””â”€â”€ ConversationRepository.java # å¯¹è¯Repository
â”‚
â”œâ”€â”€ security/                       # å®‰å…¨æ¨¡å—
â”‚   â”œâ”€â”€ JwtTokenProvider.java      # JWTä»¤ç‰Œæä¾›è€…
â”‚   â””â”€â”€ JwtAuthenticationFilter.java # JWTè®¤è¯è¿‡æ»¤å™¨
â”‚
â””â”€â”€ service/                        # ä¸šåŠ¡é€»è¾‘å±‚
    â”œâ”€â”€ AuthService.java            # è®¤è¯æœåŠ¡
    â”œâ”€â”€ DocumentService.java        # æ–‡æ¡£æœåŠ¡
    â””â”€â”€ AIService.java              # AIæœåŠ¡ï¼ˆæ ¸å¿ƒï¼‰

src/main/resources/
â”œâ”€â”€ application.yml                 # åº”ç”¨é…ç½®æ–‡ä»¶ï¼ˆæ ¸å¿ƒï¼‰
â”œâ”€â”€ static/                         # é™æ€èµ„æº
â””â”€â”€ templates/                      # æ¨¡æ¿æ–‡ä»¶
```

---

## æ ¸å¿ƒæ¨¡å—è¯¦è§£

### 1ï¸âƒ£ **å…¥å£ç±» (StroveApplication.java)**

**ä½ç½®**: `src/main/java/com/erokin/strove/StroveApplication.java`

**ä½œç”¨**: Spring Bootåº”ç”¨ç¨‹åºçš„å¯åŠ¨å…¥å£

**å…³é”®ä»£ç **:
```java
@SpringBootApplication
public class StroveApplication {
    public static void main(String[] args) {
        SpringApplication.run(StroveApplication.class, args);
    }
}
```

**ä¿®æ”¹å»ºè®®**: 
- åŸºæœ¬ä¸éœ€è¦ä¿®æ”¹
- å¦‚éœ€æ·»åŠ å…¨å±€é…ç½®æ³¨è§£ï¼Œå¯åœ¨æ­¤ç±»ä¸Šæ·»åŠ 

---

### 2ï¸âƒ£ **é…ç½®åŒ… (config/)**

#### **SecurityConfig.java** â­æ ¸å¿ƒé…ç½®
**ä½œç”¨**: é…ç½®Spring Securityå’ŒJWTè®¤è¯

**å…³é”®åŠŸèƒ½**:
- é…ç½®å“ªäº›æ¥å£éœ€è¦è®¤è¯ï¼Œå“ªäº›å¯ä»¥å…¬å¼€è®¿é—®
- é›†æˆJWTè¿‡æ»¤å™¨
- é…ç½®å¯†ç åŠ å¯†å™¨

**éœ€è¦ä¿®æ”¹çš„åœºæ™¯**:
- âœ… æ·»åŠ æ–°çš„å…¬å¼€æ¥å£ï¼ˆä¸éœ€è¦ç™»å½•ï¼‰
- âœ… ä¿®æ”¹JWTç›¸å…³é…ç½®
- âœ… è°ƒæ•´CORSç­–ç•¥

**ç¤ºä¾‹ä¿®æ”¹**:
```java
// åœ¨SecurityConfigä¸­æ·»åŠ å…¬å¼€æ¥å£
http.authorizeHttpRequests()
    .requestMatchers("/api/auth/**").permitAll()
    .requestMatchers("/api/æ–°æ¥å£/**").permitAll()  // æ·»åŠ è¿™è¡Œ
    .anyRequest().authenticated();
```

---

#### **WebConfig.java**
**ä½œç”¨**: é…ç½®Webç›¸å…³è®¾ç½®ï¼ˆCORSè·¨åŸŸï¼‰

**ä¿®æ”¹åœºæ™¯**:
- å‰ç«¯åœ°å€å˜æ›´æ—¶ä¿®æ”¹CORSé…ç½®
- æ·»åŠ æ–°çš„è·¨åŸŸåŸŸå

---

#### **DatabaseAutoFixer.java**
**ä½œç”¨**: è‡ªåŠ¨æ£€æµ‹å’Œä¿®å¤æ•°æ®åº“è¿æ¥é—®é¢˜

**ä¿®æ”¹åœºæ™¯**:
- åŸºæœ¬ä¸éœ€è¦ä¿®æ”¹
- å¦‚éœ€è‡ªå®šä¹‰æ•°æ®åº“åˆå§‹åŒ–é€»è¾‘ï¼Œå¯åœ¨æ­¤æ·»åŠ 

---

#### **HttpClientConfig.java**
**ä½œç”¨**: é…ç½®HTTPå®¢æˆ·ç«¯ï¼ˆç”¨äºè°ƒç”¨å¤–éƒ¨AI APIï¼‰

**ä¿®æ”¹åœºæ™¯**:
- è°ƒæ•´HTTPè¶…æ—¶æ—¶é—´
- é…ç½®ä»£ç†è®¾ç½®

---

### 3ï¸âƒ£ **æ§åˆ¶å™¨å±‚ (controller/)** â­é‡ç‚¹ä¿®æ”¹åŒºåŸŸ

æ§åˆ¶å™¨è´Ÿè´£**å¤„ç†HTTPè¯·æ±‚**ï¼Œæ˜¯å‰åç«¯äº¤äº’çš„æ¥å£å±‚ã€‚

#### **AuthController.java** - è®¤è¯æ¥å£
**è·¯å¾„**: `/api/auth`

**ç«¯ç‚¹**:
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•

**ä¿®æ”¹ç¤ºä¾‹**:
```java
// æ·»åŠ å¿˜è®°å¯†ç åŠŸèƒ½
@PostMapping("/forgot-password")
public ResponseEntity<?> forgotPassword(@RequestBody ForgotPasswordRequest request) {
    // å®ç°é€»è¾‘
}
```

---

#### **AIController.java** - AIåŠŸèƒ½æ¥å£ â­æ ¸å¿ƒ
**è·¯å¾„**: `/api/ai`

**ç«¯ç‚¹**:
- `POST /api/ai/chat` - AIèŠå¤©å¯¹è¯
- `POST /api/ai/generate` - AIæ–‡æœ¬ç”Ÿæˆ
- `POST /api/ai/inspiration` - çµæ„Ÿç”Ÿæˆ

**ä¿®æ”¹ç¤ºä¾‹**:
```java
// æ·»åŠ æ–°çš„AIåŠŸèƒ½ï¼šæ–‡ç« æ¶¦è‰²
@PostMapping("/polish")
public ResponseEntity<?> polishText(@RequestBody PolishRequest request) {
    String polished = aiService.polishText(request.getText());
    return ResponseEntity.ok(new ApiResponse<>(true, polished));
}
```

---

#### **DocumentController.java** - æ–‡æ¡£ç®¡ç†æ¥å£
**è·¯å¾„**: `/api/documents`

**ç«¯ç‚¹**:
- `GET /api/documents` - è·å–ç”¨æˆ·æ‰€æœ‰æ–‡æ¡£
- `POST /api/documents` - åˆ›å»ºæ–°æ–‡æ¡£
- `PUT /api/documents/{id}` - æ›´æ–°æ–‡æ¡£
- `DELETE /api/documents/{id}` - åˆ é™¤æ–‡æ¡£
- `GET /api/documents/{id}` - è·å–å•ä¸ªæ–‡æ¡£

**ä¿®æ”¹ç¤ºä¾‹**:
```java
// æ·»åŠ æ–‡æ¡£åˆ†äº«åŠŸèƒ½
@PostMapping("/{id}/share")
public ResponseEntity<?> shareDocument(@PathVariable Long id) {
    String shareLink = documentService.generateShareLink(id);
    return ResponseEntity.ok(new ApiResponse<>(true, shareLink));
}
```

---

#### **ToolController.java** - å·¥å…·æ¥å£
**è·¯å¾„**: `/api/tools`

**ç«¯ç‚¹**:
- `POST /api/tools/word-count` - å­—æ•°ç»Ÿè®¡

**ä¿®æ”¹åœºæ™¯**: æ·»åŠ æ–°çš„æ–‡æœ¬å·¥å…·åŠŸèƒ½

---

#### **HealthController.java** - å¥åº·æ£€æŸ¥
**è·¯å¾„**: `/api/health`

**ç«¯ç‚¹**:
- `GET /api/health` - æ£€æŸ¥æœåŠ¡çŠ¶æ€

**ä¿®æ”¹åœºæ™¯**: åŸºæœ¬ä¸éœ€è¦ä¿®æ”¹

---

### 4ï¸âƒ£ **æœåŠ¡å±‚ (service/)** â­æ ¸å¿ƒä¸šåŠ¡é€»è¾‘

#### **AIService.java** â­â­â­ æœ€é‡è¦çš„æœåŠ¡ç±»
**ä½œç”¨**: å¤„ç†æ‰€æœ‰AIç›¸å…³çš„ä¸šåŠ¡é€»è¾‘

**å…³é”®æ–¹æ³•**:
```java
// AIèŠå¤©
public ChatResponse chat(ChatRequest request, String username)

// AIæ–‡æœ¬ç”Ÿæˆ
public String generate(String prompt, String context, String username)

// çµæ„Ÿç”Ÿæˆ
public String generateInspiration(InspirationRequest request)
```

**ä¿®æ”¹å»ºè®®**:
- âœ… ä¿®æ”¹AIæç¤ºè¯ï¼ˆPromptï¼‰
- âœ… è°ƒæ•´AIå‚æ•°ï¼ˆtemperatureã€max_tokensç­‰ï¼‰
- âœ… æ·»åŠ æ–°çš„AIåŠŸèƒ½
- âœ… æ›´æ¢AIæœåŠ¡æä¾›å•†

**ç¤ºä¾‹ä¿®æ”¹**:
```java
// ä¿®æ”¹ç”Ÿæˆæ–‡æœ¬çš„æç¤ºè¯
private String buildSystemPrompt(String context) {
    return "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å†™ä½œåŠ©æ‰‹ï¼Œæ“…é•¿åˆ›ä½œå„ç±»æ–‡æ¡ˆã€‚" + 
           "è¯·æ ¹æ®ç”¨æˆ·çš„éœ€æ±‚ç”Ÿæˆé«˜è´¨é‡å†…å®¹ã€‚" +
           "é¢å¤–è¦æ±‚ï¼š" + context;  // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æ›´å¤šæŒ‡ä»¤
}
```

---

#### **AuthService.java** - è®¤è¯æœåŠ¡
**ä½œç”¨**: å¤„ç†ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€JWTç”Ÿæˆ

**å…³é”®æ–¹æ³•**:
```java
public AuthResponse register(RegisterRequest request)
public AuthResponse login(LoginRequest request)
```

**ä¿®æ”¹åœºæ™¯**:
- æ·»åŠ é‚®ç®±éªŒè¯é€»è¾‘
- ä¿®æ”¹å¯†ç å¼ºåº¦è¦æ±‚
- æ·»åŠ ç¬¬ä¸‰æ–¹ç™»å½•

---

#### **DocumentService.java** - æ–‡æ¡£æœåŠ¡
**ä½œç”¨**: å¤„ç†æ–‡æ¡£çš„å¢åˆ æ”¹æŸ¥

**å…³é”®æ–¹æ³•**:
```java
public List<Document> getUserDocuments(Long userId)
public Document createDocument(DocumentRequest request, Long userId)
public Document updateDocument(Long id, DocumentRequest request, Long userId)
public void deleteDocument(Long id, Long userId)
```

**ä¿®æ”¹åœºæ™¯**:
- æ·»åŠ æ–‡æ¡£ç‰ˆæœ¬æ§åˆ¶
- å®ç°æ–‡æ¡£åˆ†ç±»åŠŸèƒ½
- æ·»åŠ æ–‡æ¡£å¯¼å‡ºåŠŸèƒ½

---

### 5ï¸âƒ£ **å®ä½“ç±» (entity/)**

å®ä½“ç±»æ˜ å°„æ•°æ®åº“è¡¨ç»“æ„ã€‚

#### **User.java** - ç”¨æˆ·å®ä½“
```java
@Entity
@Table(name = "users")
public class User {
    private Long id;
    private String username;
    private String email;
    private String password;
    private LocalDateTime createdAt;
    private LocalDateTime updatedAt;
}
```

**ä¿®æ”¹åœºæ™¯**:
- æ·»åŠ ç”¨æˆ·å¤´åƒå­—æ®µï¼š`private String avatar;`
- æ·»åŠ ç”¨æˆ·è§’è‰²ï¼š`private String role;`

---

#### **Document.java** - æ–‡æ¡£å®ä½“
```java
@Entity
@Table(name = "documents")
public class Document {
    private Long id;
    private Long userId;
    private String title;
    private String content;
    private Integer wordCount;
    private LocalDateTime createdAt;
    private LocalDateTime updatedAt;
}
```

**ä¿®æ”¹åœºæ™¯**:
- æ·»åŠ æ–‡æ¡£åˆ†ç±»ï¼š`private String category;`
- æ·»åŠ æ–‡æ¡£æ ‡ç­¾ï¼š`private String tags;`

---

#### **Conversation.java** - å¯¹è¯å®ä½“
```java
@Entity
@Table(name = "conversations")
public class Conversation {
    private Long id;
    private Long userId;
    private Long documentId;
    private String message;
    private String response;
    private LocalDateTime createdAt;
}
```

---

### 6ï¸âƒ£ **Repositoryå±‚ (repository/)**

Repositoryè´Ÿè´£æ•°æ®åº“è®¿é—®ï¼ŒåŸºäºSpring Data JPAã€‚

#### **UserRepository.java**
```java
public interface UserRepository extends JpaRepository<User, Long> {
    Optional<User> findByUsername(String username);
    Optional<User> findByEmail(String email);
    boolean existsByUsername(String username);
    boolean existsByEmail(String email);
}
```

**ä¿®æ”¹åœºæ™¯**: æ·»åŠ è‡ªå®šä¹‰æŸ¥è¯¢æ–¹æ³•
```java
// æŒ‰åˆ›å»ºæ—¶é—´æŸ¥æ‰¾ç”¨æˆ·
List<User> findByCreatedAtAfter(LocalDateTime date);
```

---

#### **DocumentRepository.java**
```java
public interface DocumentRepository extends JpaRepository<Document, Long> {
    List<Document> findByUserIdOrderByUpdatedAtDesc(Long userId);
    List<Document> findByUserIdAndTitleContainingIgnoreCaseOrderByUpdatedAtDesc(
        Long userId, String title);
}
```

**ä¿®æ”¹åœºæ™¯**: æ·»åŠ æœç´¢ã€ç­›é€‰åŠŸèƒ½

---

### 7ï¸âƒ£ **DTOåŒ… (dto/)**

DTOç”¨äºå‰åç«¯æ•°æ®ä¼ è¾“ï¼Œä¸å®ä½“ç±»åŒºåˆ†å¼€ã€‚

#### **ApiResponse.java** - ç»Ÿä¸€å“åº”æ ¼å¼
```java
public class ApiResponse<T> {
    private boolean success;
    private String message;
    private T data;
}
```

**ä¿®æ”¹åœºæ™¯**: åŸºæœ¬ä¸éœ€è¦ä¿®æ”¹

---

#### **ChatRequest.java / ChatResponse.java**
ç”¨äºAIèŠå¤©æ¥å£çš„è¯·æ±‚å’Œå“åº”ã€‚

**ä¿®æ”¹åœºæ™¯**: 
- æ·»åŠ æ–°çš„è¯·æ±‚å‚æ•°
- æ‰©å±•å“åº”å†…å®¹

---

### 8ï¸âƒ£ **å®‰å…¨æ¨¡å— (security/)**

#### **JwtTokenProvider.java** - JWTå·¥å…·ç±»
**ä½œç”¨**: ç”Ÿæˆå’ŒéªŒè¯JWTä»¤ç‰Œ

**å…³é”®æ–¹æ³•**:
```java
public String generateToken(String username)
public String getUsernameFromToken(String token)
public boolean validateToken(String token)
```

**ä¿®æ”¹åœºæ™¯**:
- è°ƒæ•´JWTè¿‡æœŸæ—¶é—´
- ä¿®æ”¹JWTå¯†é’¥
- æ·»åŠ åˆ·æ–°ä»¤ç‰ŒåŠŸèƒ½

---

#### **JwtAuthenticationFilter.java** - JWTè¿‡æ»¤å™¨
**ä½œç”¨**: æ‹¦æˆªè¯·æ±‚ï¼ŒéªŒè¯JWTä»¤ç‰Œ

**ä¿®æ”¹åœºæ™¯**: åŸºæœ¬ä¸éœ€è¦ä¿®æ”¹

---

### 9ï¸âƒ£ **å¼‚å¸¸å¤„ç† (exception/)**

#### **GlobalExceptionHandler.java**
**ä½œç”¨**: å…¨å±€å¼‚å¸¸æ•è·å’Œå¤„ç†

**ä¿®æ”¹åœºæ™¯**:
- æ·»åŠ è‡ªå®šä¹‰å¼‚å¸¸ç±»å‹
- ä¿®æ”¹é”™è¯¯å“åº”æ ¼å¼

---

## é…ç½®è¯´æ˜

### **application.yml** â­æ ¸å¿ƒé…ç½®æ–‡ä»¶

**ä½ç½®**: `src/main/resources/application.yml`

#### æ•°æ®åº“é…ç½®
```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/strove_db
    username: root
    password: 123456
```

**ä¿®æ”¹æ—¶æœº**: 
- æ›´æ¢æ•°æ®åº“åœ°å€
- æ›´æ”¹æ•°æ®åº“ç”¨æˆ·åå¯†ç 

---

#### JWTé…ç½®
```yaml
app:
  security:
    jwt:
      secret: strove-ai-writing-assistant-jwt-secret-key
      expiration-ms: 86400000  # 24å°æ—¶
```

**ä¿®æ”¹æ—¶æœº**:
- è°ƒæ•´ä»¤ç‰Œè¿‡æœŸæ—¶é—´
- æ›´æ¢JWTå¯†é’¥ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…é¡»ä¿®æ”¹ï¼‰

---

#### AIæœåŠ¡é…ç½®
```yaml
app:
  ai:
    enabled: false
    api-key: ${AI_API_KEY:}
    api-endpoint: ${AI_API_ENDPOINT:}
    model: gpt-3.5-turbo
    max-tokens: 2000
    temperature: 0.7
```

**ä¿®æ”¹æ—¶æœº**: â­é‡è¦
- é›†æˆçœŸå®AIæœåŠ¡æ—¶å¿…é¡»ä¿®æ”¹
- è°ƒæ•´AIå‚æ•°ä¼˜åŒ–ç”Ÿæˆæ•ˆæœ

---

#### æœåŠ¡å™¨ç«¯å£
```yaml
server:
  port: 8123
```

**ä¿®æ”¹æ—¶æœº**: ç«¯å£å†²çªæ—¶ä¿®æ”¹

---

## å¿«é€Ÿä¿®æ”¹æŒ‡å—

### ğŸ¯ åœºæ™¯1: æ·»åŠ æ–°çš„APIæ¥å£

**æ­¥éª¤**:
1. åœ¨å¯¹åº”çš„ **Controller** ä¸­æ·»åŠ æ–¹æ³•
2. åœ¨å¯¹åº”çš„ **Service** ä¸­å®ç°ä¸šåŠ¡é€»è¾‘
3. å¦‚éœ€æ•°æ®åº“æ“ä½œï¼Œåœ¨ **Repository** ä¸­æ·»åŠ æ–¹æ³•
4. åˆ›å»ºå¯¹åº”çš„ **DTO** ç±»ï¼ˆå¦‚éœ€è¦ï¼‰

**ç¤ºä¾‹**: æ·»åŠ "æ–‡ç« æ‘˜è¦ç”Ÿæˆ"åŠŸèƒ½

```java
// 1. Controllerå±‚ (AIController.java)
@PostMapping("/summarize")
public ResponseEntity<?> summarize(@RequestBody SummarizeRequest request) {
    String summary = aiService.generateSummary(request.getText());
    return ResponseEntity.ok(new ApiResponse<>(true, summary));
}

// 2. Serviceå±‚ (AIService.java)
public String generateSummary(String text) {
    String prompt = "è¯·ä¸ºä»¥ä¸‹æ–‡ç« ç”Ÿæˆæ‘˜è¦ï¼š\n\n" + text;
    return callAIModel(prompt, 0.5, 500);
}

// 3. DTOå±‚ (SummarizeRequest.java)
public class SummarizeRequest {
    private String text;
    // getters/setters
}
```

---

### ğŸ¯ åœºæ™¯2: ä¿®æ”¹AIç”Ÿæˆçš„å†…å®¹é£æ ¼

**ä½ç½®**: `AIService.java`

**ä¿®æ”¹æ–¹æ³•**:
```java
// æ‰¾åˆ°å¯¹åº”æ–¹æ³•ä¸­çš„æç¤ºè¯ï¼ˆpromptï¼‰éƒ¨åˆ†
private String buildPrompt(String userInput) {
    return "ç³»ç»Ÿæç¤ºï¼šä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å†™ä½œåŠ©æ‰‹ã€‚\n" +
           "é£æ ¼è¦æ±‚ï¼šæ­£å¼ã€ä¸“ä¸šã€ç®€æ´ã€‚\n" +    // ä¿®æ”¹è¿™é‡Œ
           "ç”¨æˆ·è¾“å…¥ï¼š" + userInput;
}
```

---

### ğŸ¯ åœºæ™¯3: æ·»åŠ æ•°æ®åº“å­—æ®µ

**æ­¥éª¤**:
1. åœ¨ **Entity** ç±»ä¸­æ·»åŠ å±æ€§
2. æ•°æ®åº“ä¼šè‡ªåŠ¨æ›´æ–°ï¼ˆå› ä¸º`ddl-auto: update`ï¼‰
3. åœ¨ **DTO** ä¸­æ·»åŠ å¯¹åº”å­—æ®µ
4. åœ¨ **Service** ä¸­å¤„ç†æ–°å­—æ®µçš„é€»è¾‘

**ç¤ºä¾‹**: ç»™ç”¨æˆ·æ·»åŠ å¤´åƒå­—æ®µ

```java
// 1. User.java
@Column(length = 500)
private String avatar;

// 2. RegisterRequest.java
private String avatar;

// 3. AuthService.java - registeræ–¹æ³•
user.setAvatar(request.getAvatar());
```

---

### ğŸ¯ åœºæ™¯4: è°ƒæ•´JWTè¿‡æœŸæ—¶é—´

**ä½ç½®**: `application.yml`

```yaml
app:
  security:
    jwt:
      expiration-ms: 604800000  # æ”¹ä¸º7å¤© (7*24*60*60*1000)
```

---

### ğŸ¯ åœºæ™¯5: æ·»åŠ æ¥å£æƒé™æ§åˆ¶

**ä½ç½®**: `SecurityConfig.java`

```java
@Bean
public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
    http
        .authorizeHttpRequests(auth -> auth
            .requestMatchers("/api/auth/**").permitAll()
            .requestMatchers("/api/admin/**").hasRole("ADMIN")  // æ·»åŠ ç®¡ç†å‘˜æƒé™
            .anyRequest().authenticated()
        );
    return http.build();
}
```

---

### ğŸ¯ åœºæ™¯6: æ›´æ¢AIæœåŠ¡æä¾›å•†

**ä½ç½®**: `AIService.java` ä¸­çš„ `callAIModel` æ–¹æ³•

**ä¿®æ”¹æ­¥éª¤**:
1. æ‰¾åˆ°HTTPè¯·æ±‚æ„å»ºéƒ¨åˆ†
2. ä¿®æ”¹APIç«¯ç‚¹URL
3. ä¿®æ”¹è¯·æ±‚ä½“æ ¼å¼
4. ä¿®æ”¹å“åº”è§£æé€»è¾‘

**ç¤ºä¾‹**: ä»OpenAIæ”¹ä¸ºClaude
```java
private String callAIModel(String prompt, double temperature, int maxTokens) {
    // ä¿®æ”¹è¯·æ±‚URL
    String apiUrl = "https://api.anthropic.com/v1/messages";
    
    // ä¿®æ”¹è¯·æ±‚ä½“æ ¼å¼
    String requestBody = buildClaudeRequest(prompt, temperature, maxTokens);
    
    // ä¿®æ”¹è§£æé€»è¾‘
    return parseClaudeResponse(response);
}
```

---

## å¸¸è§ä¿®æ”¹åœºæ™¯

### âœ… ç®€å•ä¿®æ”¹ï¼ˆ5-15åˆ†é’Ÿï¼‰
- è°ƒæ•´AIå‚æ•°ï¼ˆtemperatureã€max_tokensï¼‰
- ä¿®æ”¹æç¤ºè¯å†…å®¹
- è°ƒæ•´JWTè¿‡æœŸæ—¶é—´
- ä¿®æ”¹CORSé…ç½®
- æ·»åŠ ç®€å•çš„å·¥å…·æ¥å£

### âš™ï¸ ä¸­ç­‰ä¿®æ”¹ï¼ˆ30-60åˆ†é’Ÿï¼‰
- æ·»åŠ æ–°çš„APIæ¥å£
- æ·»åŠ æ•°æ®åº“å­—æ®µ
- å®ç°æ–°çš„AIåŠŸèƒ½
- æ·»åŠ æ•°æ®éªŒè¯é€»è¾‘
- ä¿®æ”¹å“åº”æ ¼å¼

### ğŸ”§ å¤æ‚ä¿®æ”¹ï¼ˆ2å°æ—¶ä»¥ä¸Šï¼‰
- æ›´æ¢AIæœåŠ¡æä¾›å•†
- æ·»åŠ ç¬¬ä¸‰æ–¹ç™»å½•
- å®ç°æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
- æ·»åŠ æ”¯ä»˜é›†æˆ
- å®ç°å®æ—¶é€šä¿¡ï¼ˆWebSocketï¼‰

---

## ğŸ“ ä¿®æ”¹å»ºè®®å’Œæœ€ä½³å®è·µ

### 1. **ä¿®æ”¹å‰å¤‡ä»½**
```bash
git add .
git commit -m "å¤‡ä»½ï¼šå‡†å¤‡ä¿®æ”¹XXXåŠŸèƒ½"
```

### 2. **éµå¾ªåˆ†å±‚åŸåˆ™**
- Controlleråªè´Ÿè´£è¯·æ±‚å¤„ç†å’Œå“åº”
- ServiceåŒ…å«ä¸šåŠ¡é€»è¾‘
- Repositoryåªè´Ÿè´£æ•°æ®è®¿é—®
- ä¸è¦è·¨å±‚è°ƒç”¨

### 3. **ç»Ÿä¸€å¼‚å¸¸å¤„ç†**
ä½¿ç”¨`GlobalExceptionHandler`ç»Ÿä¸€æ•è·å¼‚å¸¸ï¼Œä¸è¦åœ¨æ¯ä¸ªæ–¹æ³•ä¸­try-catch

### 4. **ä½¿ç”¨DTOè€ŒéEntity**
å‰ç«¯äº¤äº’ä½¿ç”¨DTOï¼Œä¸è¦ç›´æ¥æš´éœ²Entity

### 5. **æ·»åŠ æ—¥å¿—**
```java
import lombok.extern.slf4j.Slf4j;

@Slf4j
@Service
public class YourService {
    public void someMethod() {
        log.info("æ‰§è¡ŒæŸæ“ä½œï¼Œå‚æ•°ï¼š{}", param);
        log.error("å‘ç”Ÿé”™è¯¯", exception);
    }
}
```

### 6. **æ•°æ®åº“è¿ç§»**
ç”Ÿäº§ç¯å¢ƒå»ºè®®å…³é—­`ddl-auto: update`ï¼Œä½¿ç”¨Flywayè¿›è¡Œæ•°æ®åº“ç‰ˆæœ¬ç®¡ç†

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [å¿«é€Ÿå¯åŠ¨æŒ‡å—.md](./å¿«é€Ÿå¯åŠ¨æŒ‡å—.md) - å¦‚ä½•è¿è¡Œé¡¹ç›®
- [åç«¯æ¥å£æ–‡æ¡£.md](./åç«¯æ¥å£æ–‡æ¡£.md) - APIæ¥å£è¯¦ç»†è¯´æ˜
- [å¼€å‘æŒ‡å—.md](./å¼€å‘æŒ‡å—.md) - å¼€å‘è§„èŒƒå’Œæµç¨‹

---

## ğŸ“§ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚éœ€ä¿®æ”¹ç‰¹å®šåŠŸèƒ½ï¼Œè¯·å‚è€ƒæœ¬æ–‡æ¡£å¯¹åº”ç« èŠ‚ï¼Œæˆ–æŸ¥çœ‹ä»£ç ä¸­çš„æ³¨é‡Šè¯´æ˜ã€‚

**æœ€åæ›´æ–°**: 2026-01-04
