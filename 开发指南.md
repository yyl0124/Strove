# Strove AI å†™ä½œåŠ©æ‰‹ - å¼€å‘å¿«é€Ÿä¸Šæ‰‹æŒ‡å—

## ğŸ¯ é¡¹ç›®ç®€ä»‹
Stroveæ˜¯ä¸€ä¸ªè½»é‡çº§AIå†™ä½œè¾…åŠ©å·¥å…·ï¼Œç”¨æˆ·ä½¿ç”¨è‡ªå·±çš„AIå¤§æ¨¡å‹å¯†é’¥ï¼ˆOpenAI/é€šä¹‰åƒé—®/æ–‡å¿ƒä¸€è¨€ï¼‰è¿›è¡Œå†™ä½œè¾…åŠ©ã€‚

---

## ğŸ“ é¡¹ç›®ç»“æ„
```
campus-club-management/
â”œâ”€â”€ src/main/java/com/erokin/strove/     # åç«¯æºç 
â”‚   â”œâ”€â”€ StroveApplication.java           # ä¸»åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ config/                          # é…ç½®ç±»
â”‚   â”‚   â”œâ”€â”€ WebConfig.java              # CORSé…ç½®
â”‚   â”‚   â””â”€â”€ properties/                  # é…ç½®å±æ€§
â”‚   â”œâ”€â”€ entity/                          # å®ä½“ç±»
â”‚   â”‚   â”œâ”€â”€ User.java
â”‚   â”‚   â”œâ”€â”€ Document.java
â”‚   â”‚   â””â”€â”€ Conversation.java
â”‚   â”œâ”€â”€ repository/                      # æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ dto/                             # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”œâ”€â”€ controller/                      # æ§åˆ¶å™¨ï¼ˆå¾…å¼€å‘ï¼‰
â”‚   â”œâ”€â”€ service/                         # æœåŠ¡å±‚ï¼ˆå¾…å¼€å‘ï¼‰
â”‚   â””â”€â”€ security/                        # å®‰å…¨é…ç½®ï¼ˆå¾…å¼€å‘ï¼‰
â”œâ”€â”€ src/main/resources/
â”‚   â””â”€â”€ application.yml                  # åº”ç”¨é…ç½®
â”œâ”€â”€ frontend/                            # å‰ç«¯æºç 
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ views/                      # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Auth/                   # è®¤è¯é¡µé¢ âœ…
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard/              # ä¸»é¡µ âœ…
â”‚   â”‚   â”‚   â”œâ”€â”€ Documents/              # æ–‡æ¡£ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ Chat/                   # AIå¯¹è¯
â”‚   â”‚   â”‚   â””â”€â”€ Settings/               # è®¾ç½®ï¼ˆå¾…åˆ›å»ºï¼‰
â”‚   â”‚   â”œâ”€â”€ components/                 # å…¬å…±ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ api/                        # APIæ¥å£
â”‚   â”‚   â”œâ”€â”€ stores/                     # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ router/                     # è·¯ç”±é…ç½®
â”‚   â”‚   â””â”€â”€ main.ts                     # å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.ts
â”œâ”€â”€ README.md                            # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ éœ€æ±‚è§„æ ¼.md                          # éœ€æ±‚æ–‡æ¡£
â””â”€â”€ REFACTORING.md                       # é‡æ„æ€»ç»“
```

---

## ğŸ› ï¸ å¼€å‘ç¯å¢ƒæ­å»º

### 1. å‰ç½®è¦æ±‚
- **JDK**: 21+
- **Maven**: 3.9+
- **Node.js**: 18+
- **MySQL**: 8+
- **IDE**: IntelliJ IDEA / VS Code

### 2. å…‹éš†é¡¹ç›®
```bash
cd e:\PROJECT\campus-club-management
```

### 3. æ•°æ®åº“å‡†å¤‡
```sql
-- è¿æ¥MySQLå¹¶åˆ›å»ºæ•°æ®åº“
CREATE DATABASE strove_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- æˆæƒï¼ˆå¦‚éœ€è¦ï¼‰
GRANT ALL PRIVILEGES ON strove_db.* TO 'your_user'@'localhost';
FLUSH PRIVILEGES;
```

### 4. åç«¯å¯åŠ¨
```bash
# é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼Œæˆ–ç›´æ¥ä¿®æ”¹application.ymlï¼‰
export DB_URL="jdbc:mysql://localhost:3306/strove_db?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Shanghai"
export DB_USERNAME="root"
export DB_PASSWORD="your_password"
export JWT_SECRET="your-very-secure-secret-key-32-chars-min"

# å¯åŠ¨åç«¯
mvn spring-boot:run

# æˆ–è€…åœ¨IDEä¸­è¿è¡Œ StroveApplication.java
```

åç«¯é»˜è®¤è¿è¡Œåœ¨ `http://localhost:8123`

### 5. å‰ç«¯å¯åŠ¨
```bash
cd frontend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

å‰ç«¯é»˜è®¤è¿è¡Œåœ¨ `http://localhost:5173`

---

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½å¼€å‘æŒ‡å—

### é˜¶æ®µ1: å®Œæˆç”¨æˆ·è®¤è¯ï¼ˆ1-2å¤©ï¼‰

#### åç«¯ä»»åŠ¡
1. **åˆ›å»ºJWTå·¥å…·ç±»**
```java
// src/main/java/com/erokin/strove/security/JwtTokenProvider.java
```

2. **åˆ›å»ºSecurityé…ç½®**
```java
// src/main/java/com/erokin/strove/security/SecurityConfig.java
// é…ç½®JWTè¿‡æ»¤å™¨ã€å…è®¸çš„è·¯å¾„ç­‰
```

3. **åˆ›å»ºè®¤è¯æœåŠ¡**
```java
// src/main/java/com/erokin/strove/service/AuthService.java
// å®ç°æ³¨å†Œã€ç™»å½•é€»è¾‘
```

4. **åˆ›å»ºè®¤è¯æ§åˆ¶å™¨**
```java
// src/main/java/com/erokin/strove/controller/AuthController.java
// POST /api/auth/register
// POST /api/auth/login
// GET  /api/auth/me
```

#### å‰ç«¯ä»»åŠ¡
âœ… å·²å®Œæˆ:
- Login.vue
- Register.vue
- stores/auth.ts
- api/auth.ts

**æµ‹è¯•**: æ³¨å†Œ â†’ ç™»å½• â†’ è·³è½¬åˆ°Dashboard

---

### é˜¶æ®µ2: AIå¯†é’¥ç®¡ç†ï¼ˆ2-3å¤©ï¼‰

#### å‰ç«¯ä»»åŠ¡ï¼ˆä¼˜å…ˆï¼‰
**åˆ›å»ºå¯†é’¥é…ç½®é¡µé¢**:
```bash
# åˆ›å»ºæ–‡ä»¶
frontend/src/views/Settings/APIKeyConfig.vue
frontend/src/stores/settings.ts
```

**APIKeyConfig.vue æ ¸å¿ƒåŠŸèƒ½**:
```vue
<template>
  <el-card>
    <h2>AIå¯†é’¥é…ç½®</h2>
    
    <!-- AIæœåŠ¡å•†é€‰æ‹© -->
    <el-select v-model="provider">
      <el-option label="OpenAI" value="openai" />
      <el-option label="é€šä¹‰åƒé—®" value="qianwen" />
      <el-option label="æ–‡å¿ƒä¸€è¨€" value="wenxin" />
    </el-select>
    
    <!-- APIå¯†é’¥è¾“å…¥ -->
    <el-input 
      v-model="apiKey" 
      type="password" 
      placeholder="è¯·è¾“å…¥APIå¯†é’¥"
    />
    
    <!-- ä¿å­˜æŒ‰é’® -->
    <el-button @click="saveKey">ä¿å­˜å¹¶éªŒè¯</el-button>
  </el-card>
</template>

<script setup lang="ts">
// å°†å¯†é’¥åŠ å¯†åå­˜å‚¨åˆ°localStorage
const saveKey = () => {
  // ä½¿ç”¨CryptoJSåŠ å¯†
  const encrypted = CryptoJS.AES.encrypt(apiKey, 'secret-key')
  localStorage.setItem('ai_provider', provider)
  localStorage.setItem('ai_key', encrypted.toString())
}
</script>
```

**stores/settings.ts**:
```typescript
export const useSettingsStore = defineStore('settings', () => {
  const aiProvider = ref(localStorage.getItem('ai_provider') || '')
  const aiKey = ref('')
  
  const loadKey = () => {
    const encrypted = localStorage.getItem('ai_key')
    if (encrypted) {
      // è§£å¯†
      const decrypted = CryptoJS.AES.decrypt(encrypted, 'secret-key')
      aiKey.value = decrypted.toString(CryptoJS.enc.Utf8)
    }
  }
  
  return { aiProvider, aiKey, loadKey }
})
```

**è·¯ç”±æ›´æ–°**:
```typescript
// frontend/src/router/index.ts
{
  path: '/settings',
  name: 'settings',
  component: () => import('../views/Settings/APIKeyConfig.vue'),
  meta: { requiresAuth: true }
}
```

**å®‰è£…åŠ å¯†åº“**:
```bash
npm install crypto-js
npm install --save-dev @types/crypto-js
```

---

### é˜¶æ®µ3: AIå¯¹è¯åŠŸèƒ½ï¼ˆ3-4å¤©ï¼‰

#### åç«¯ä»»åŠ¡
**1. åˆ›å»ºAIæœåŠ¡æ¥å£**
```java
// src/main/java/com/erokin/strove/service/AIService.java
public interface AIService {
    AIResponse chat(String message, String apiKey, String model);
}
```

**2. å®ç°OpenAIæœåŠ¡**
```java
// src/main/java/com/erokin/strove/service/impl/OpenAIServiceImpl.java
@Service
public class OpenAIServiceImpl implements AIService {
    @Override
    public AIResponse chat(String message, String apiKey, String model) {
        // è°ƒç”¨OpenAI API
        RestTemplate restTemplate = new RestTemplate();
        HttpHeaders headers = new HttpHeaders();
        headers.setBearerAuth(apiKey);
        // ...
    }
}
```

**3. åˆ›å»ºAIæ§åˆ¶å™¨**
```java
// src/main/java/com/erokin/strove/controller/AIController.java
@RestController
@RequestMapping("/api/ai")
public class AIController {
    
    @PostMapping("/chat")
    public ResponseEntity<AIResponse> chat(@RequestBody AIRequest request) {
        // ä»requestä¸­è·å–å¯†é’¥å’Œæ¶ˆæ¯
        // è°ƒç”¨AIService
        // è¿”å›ç»“æœ
    }
}
```

**DTOç±»**:
```java
// AIRequest.java
public class AIRequest {
    private String message;
    private String provider;  // openai/qianwen/wenxin
    private String apiKey;    // å‰ç«¯ä¼ é€’
    private String model;     // gpt-3.5-turboç­‰
}

// AIResponse.java
public class AIResponse {
    private String reply;
    private String model;
    private int tokensUsed;
}
```

#### å‰ç«¯ä»»åŠ¡
**å®Œå–„Chat/ChatInterface.vue**:
```vue
<template>
  <div class="chat-container">
    <!-- æ¶ˆæ¯åˆ—è¡¨ -->
    <div class="messages">
      <MessageBubble 
        v-for="msg in messages" 
        :key="msg.id"
        :message="msg"
        @delete="deleteMessage"
        @rewrite="rewriteMessage"
      />
    </div>
    
    <!-- è¾“å…¥æ¡† -->
    <div class="input-area">
      <el-button @click="showTemplates">æ¨¡æ¿</el-button>
      <el-input 
        v-model="inputMessage" 
        @keypress.enter="sendMessage"
        placeholder="è¾“å…¥æ‚¨çš„å†™ä½œéœ€æ±‚..."
      />
      <el-button @click="sendMessage" type="primary">å‘é€</el-button>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { useSettingsStore } from '../../stores/settings'
import { aiApi } from '../../api/ai'

const settingsStore = useSettingsStore()
const messages = ref<Message[]>([])
const inputMessage = ref('')

const sendMessage = async () => {
  if (!inputMessage.value.trim()) return
  
  // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
  messages.value.push({
    id: Date.now().toString(),
    role: 'user',
    content: inputMessage.value,
    timestamp: Date.now()
  })
  
  // è°ƒç”¨AI API
  try {
    const response = await aiApi.chat({
      message: inputMessage.value,
      provider: settingsStore.aiProvider,
      apiKey: settingsStore.aiKey
    })
    
    // æ·»åŠ AIå›å¤
    messages.value.push({
      id: Date.now().toString(),
      role: 'assistant',
      content: response.data.reply,
      timestamp: Date.now()
    })
  } catch (error) {
    ElMessage.error('AIè¯·æ±‚å¤±è´¥')
  }
  
  inputMessage.value = ''
}
</script>
```

**åˆ›å»ºapi/ai.ts**:
```typescript
import apiClient from './client'

export const aiApi = {
  chat: (data: {
    message: string
    provider: string
    apiKey: string
  }) => {
    return apiClient.post('/api/ai/chat', data)
  },
  
  generateInspiration: (keyword: string, apiKey: string) => {
    return apiClient.post('/api/ai/inspiration', { keyword, apiKey })
  }
}
```

---

### é˜¶æ®µ4: Markdownç¼–è¾‘å™¨ï¼ˆ2-3å¤©ï¼‰

#### å‰ç«¯ä»»åŠ¡
**å®‰è£…Toast UI Editor**:
```bash
npm install @toast-ui/vue-editor
```

**å®Œå–„Documents/DocumentEditor.vue**:
```vue
<template>
  <div class="editor-container">
    <div class="toolbar">
      <el-button @click="saveDocument">ä¿å­˜</el-button>
      <span>æœ€åä¿å­˜: {{ lastSaved }}</span>
    </div>
    
    <Editor
      :initial-value="content"
      :options="editorOptions"
      height="calc(100vh - 100px)"
      @change="onContentChange"
    />
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue'
import { Editor } from '@toast-ui/vue-editor'
import '@toast-ui/editor/dist/toastui-editor.css'

const content = ref('')
const lastSaved = ref('')

// ä»localStorageåŠ è½½
onMounted(() => {
  const saved = localStorage.getItem('document_content')
  if (saved) {
    content.value = saved
  }
})

// è‡ªåŠ¨ä¿å­˜
let saveTimer: any
const onContentChange = () => {
  clearTimeout(saveTimer)
  saveTimer = setTimeout(() => {
    localStorage.setItem('document_content', content.value)
    lastSaved.value = new Date().toLocaleTimeString()
  }, 500)
}

const editorOptions = {
  minHeight: '400px',
  language: 'zh-CN',
  useCommandShortcut: true,
  usageStatistics: false,
  hideModeSwitch: false,
  toolbarItems: [
    ['heading', 'bold', 'italic'],
    ['ul', 'ol'],
    ['code', 'codeblock'],
    ['link']
  ]
}
</script>
```

---

### é˜¶æ®µ5: çµæ„Ÿç”Ÿæˆï¼ˆ1-2å¤©ï¼‰

**åˆ›å»ºInspiration/Generate.vue**:
```vue
<template>
  <div class="inspiration-container">
    <el-input 
      v-model="keyword" 
      placeholder="è¾“å…¥å…³é”®è¯ï¼Œå¦‚ï¼šæ˜¥æ—¥æ¸¸è®°"
      @keypress.enter="generate"
    />
    <el-button @click="generate" type="primary">ç”Ÿæˆçµæ„Ÿ</el-button>
    
    <div class="ideas-list">
      <el-card v-for="(idea, index) in ideas" :key="index">
        <p>{{ index + 1 }}. {{ idea }}</p>
        <el-button @click="copyIdea(idea)">å¤åˆ¶</el-button>
        <el-button @click="useIdea(idea)">ä½¿ç”¨</el-button>
      </el-card>
    </div>
  </div>
</template>

<script setup lang="ts">
const generate = async () => {
  const response = await aiApi.generateInspiration(keyword.value, apiKey)
  ideas.value = response.data.ideas // 3-5æ¡çµæ„Ÿ
}
</script>
```

---

## ğŸ§ª æµ‹è¯•æµç¨‹

### 1. æœ¬åœ°æµ‹è¯•
```bash
# å¯åŠ¨åç«¯
mvn spring-boot:run

# å¯åŠ¨å‰ç«¯
cd frontend && npm run dev

# è®¿é—®
æµè§ˆå™¨æ‰“å¼€: http://localhost:5173
```

### 2. åŠŸèƒ½æµ‹è¯•æ¸…å•
- [ ] ç”¨æˆ·æ³¨å†Œ
- [ ] ç”¨æˆ·ç™»å½•
- [ ] é…ç½®AIå¯†é’¥
- [ ] å‘é€AIå¯¹è¯
- [ ] æŸ¥çœ‹AIå›å¤
- [ ] ç¼–è¾‘Markdownæ–‡æ¡£
- [ ] è‡ªåŠ¨ä¿å­˜æ–‡æ¡£
- [ ] ç”Ÿæˆå†™ä½œçµæ„Ÿ
- [ ] ä½¿ç”¨æç¤ºè¯æ¨¡æ¿

---

## ğŸ“š æŠ€æœ¯æ–‡æ¡£å‚è€ƒ

- **Spring Boot**: https://spring.io/projects/spring-boot
- **Vue 3**: https://vuejs.org/
- **Element Plus**: https://element-plus.org/
- **Toast UI Editor**: https://ui.toast.com/tui-editor
- **OpenAI API**: https://platform.openai.com/docs

---

## â“ å¸¸è§é—®é¢˜

### Q1: å‰ç«¯è¿æ¥åç«¯å¤±è´¥
**A**: æ£€æŸ¥CORSé…ç½®ï¼Œç¡®ä¿`WebConfig.java`ä¸­å…è®¸äº†`http://localhost:5173`

### Q2: JWT Tokenè¿‡æœŸ
**A**: `application.yml`ä¸­é»˜è®¤24å°æ—¶ï¼Œå¯è°ƒæ•´`expiration-ms`

### Q3: Markdownç¼–è¾‘å™¨æ ·å¼ä¸æ˜¾ç¤º
**A**: ç¡®ä¿å¯¼å…¥äº†CSS: `import '@toast-ui/editor/dist/toastui-editor.css'`

### Q4: AI APIè°ƒç”¨å¤±è´¥
**A**: æ£€æŸ¥å¯†é’¥é…ç½®ã€ç½‘ç»œè¿æ¥ã€APIä½™é¢

---

## ğŸ‰ å¼€å‘å»ºè®®

1. **ä¼˜å…ˆå®ŒæˆåŸºç¡€åŠŸèƒ½**: è®¤è¯ â†’ å¯†é’¥ç®¡ç† â†’ AIå¯¹è¯
2. **å°æ­¥è¿­ä»£**: æ¯å®Œæˆä¸€ä¸ªåŠŸèƒ½å°±æµ‹è¯•
3. **ä»£ç è§„èŒƒ**: éµå¾ªJavaå’ŒTypeScriptå‘½åè§„èŒƒ
4. **æ³¨é‡Šæ¸…æ™°**: å…³é”®é€»è¾‘æ·»åŠ æ³¨é‡Š
5. **é”™è¯¯å¤„ç†**: æ‰€æœ‰APIè°ƒç”¨éƒ½è¦try-catch

---

**ç¥å¼€å‘é¡ºåˆ©ï¼ğŸš€**
